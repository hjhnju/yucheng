define("my/message/index",["require","jquery","etpl","common/header","moment","common/data","common/ui/Pager/Pager","common/Remoter","./list.tpl"],function(require){function e(){t.init();var e,a=n("#my-msg-list");r.compile(u),l.remote({status:c,page:1}),l.on("success",function(t){if(t.bizError)a.html(r.render("Error",t.statusInfo));else{if(!t.list.length)return a.html(r.render("Error",{msg:"您当前还没有消息哟"})),void n("#my-msg-pager").html("");if(!e)e=new s(n.extend({},o.pagerOpt,{main:n("#my-msg-pager"),total:+t.pageall})),e.on("change",function(e){l.remote({status:c,page:+e.value})});e.render(+t.page);for(var m=0,u=t.list.length;u>m;m++){var f=t.list[m];f.timeInfo=i.unix(+f.time).format("YYYY-MM-DD hh:mm"),f.typeInfo=d[f.type]}a.html(r.render("msgList",{list:t.list}))}}),a.delegate(".msg-content-text","click",function(){var e=n(this).attr("data-id"),r=n(this).closest(".my-invest-item");if(r.removeClass("unread"),r.hasClass("current"))r.removeClass("current");else r.addClass("current"),m.remote({mid:e})}),a.delegate(".close-detail","click",function(){n(this).closest(".my-invest-item").removeClass("current")}),n(".my-invest-tab-item").click(function(){c=+n(this).attr("data-value"),n(".my-invest-tab-item").removeClass("current"),n(this).addClass("current"),l.remote({status:c,page:1})})}var n=require("jquery"),r=require("etpl"),t=require("common/header"),i=require("moment"),o=require("common/data"),s=require("common/ui/Pager/Pager"),a=require("common/Remoter"),l=new a("MY_MSG_LIST"),m=new a("MY_MSG_SETREAD_ADD"),u=require("./list.tpl"),c=0,d={1:"充值",2:"提现"};return{init:e}});