/*! 2014 Baidu Inc. All Rights Reserved */
define("my/message/index",["require","jquery","etpl","moment","common/data","common/ui/Pager/Pager","common/Remoter","./list.tpl"],function(require){function e(){var e,s=r("#my-msg-list");t.compile(u),a.remote({status:m,page:1}),a.on("success",function(l){if(l.bizError)s.html(t.render("Error",l.statusInfo));else{if(!l.list.length)return s.html(t.render("Error",{msg:"您当前还没有消息哟"})),void r("#my-msg-pager").html("");if(!e)e=new o(r.extend({},i.pagerOpt,{main:r("#my-msg-pager"),total:+l.pageall})),e.on("change",function(e){a.remote({status:m,page:+e.value})});e.render(+l.page);for(var u=0,f=l.list.length;f>u;u++){var d=l.list[u];d.timeInfo=n.unix(+d.time).format("YYYY-MM-DD hh:mm"),d.typeInfo=c[d.type]}s.html(t.render("msgList",{list:l.list}))}}),s.delegate(".msg-content-text","click",function(){var e=r(this).attr("data-id"),t=r(this).closest(".my-invest-item");if(t.removeClass("unread"),t.hasClass("current"))t.removeClass("current");else t.addClass("current"),l.remote({mid:e})}),s.delegate(".close-detail","click",function(){r(this).closest(".my-invest-item").removeClass("current")}),r(".my-invest-tab-item").click(function(){m=+r(this).attr("data-value"),r(".my-invest-tab-item").removeClass("current"),r(this).addClass("current"),a.remote({status:m,page:1})})}var r=require("jquery"),t=require("etpl"),n=require("moment"),i=require("common/data"),o=require("common/ui/Pager/Pager"),s=require("common/Remoter"),a=new s("MY_MSG_LIST"),l=new s("MY_MSG_SETREAD_ADD"),u=require("./list.tpl"),m=0,c={1:"充值",2:"提现"};return{init:e}});