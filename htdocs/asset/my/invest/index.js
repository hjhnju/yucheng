define("my/invest/index",function(require){function e(){a=l("#my-invest-list"),d.init(),u.compile(w),g.remote({page:1}),r(),n()}function n(){l(".my-invest-tab-item").click(function(){if(!l(this).hasClass("current"))l(".my-invest-tab-item").removeClass("current"),l(this).addClass("current"),I=+l.trim(l(this).attr("data-value")),i(1)}),l(".my-invest-list").delegate(".view-plan-btn","click",function(){var e=l(".my-invest-item");if(l(this).hasClass("current"))return e.removeClass("current"),void l(this).removeClass("current");var n=l.trim(l(this).attr("data-id"));if(b=l(this),e.removeClass("current"),l(".view-plan-btn").removeClass("current"),l(this).closest(".my-invest-item").addClass("current"),l(this).addClass("current"),!l(this).hasClass("hasDetail"))v.remote({id:n})})}function r(){g.on("success",function(e){if(e.bizError)s(e);else{if(!o)o=new f(l.extend({},m.pagerOpt,{main:l("#my-invest-pager"),total:+e.pageall})),o.render(+e.page),o.on("change",function(e){i(e.value)});t("returnMoneyList",e)}}),g.on("fail",function(e){s(e)}),v.on("success",function(e){var n=l(b).closest(".my-invest-item").addClass("current").find(".my-invest-detail");if(e.bizError)n.render(u.render("Error",{msg:e.statusInfo}));else{if(!b)return;l(b).addClass("hasDetail");for(var r=0,i=e.list.length;i>r;r++)e.list[r].timeInfo=c.unix(e.list[r].time).format(T);n.html(u.render("returnMoneyDetail",{data:e}))}}),E.on("success",function(e){if(e.bizError)s(e);else t("tenderingList",e)}),E.on("fail",function(e){s(e)}),p.on("success",function(e){if(e.bizError)s(e);else t("endedList",e)}),p.on("fail",function(e){s(e)}),C.on("success",function(e){if(e.bizError)s(e);else t("tenderFailList",e)}),C.on("fail",function(e){s(e)})}function i(e){switch(a.html(u.render("Loading")),l("#my-invest-pager").html(""),I){case 1:g.remote({page:e});break;case 2:E.remote({page:e});break;case 3:p.remote({page:e});break;case 4:C.remote({page:e})}}function t(e,n){o.setOpt("pageall",+n.pageall),o.render(+n.page);for(var r=0,i=n.list.length;i>r;r++)if(n.list[r].timeInfo=c.unix(n.list[r].tenderTime).format("YYYY-MM-DD hh:mm"),n.list[r].endTime)n.list[r].endTimeInfo=c.unix(n.list[r].endTime).format(T);a.html(u.render(e,{list:n.list}))}function s(e){a.render(u.render("Error",{msg:e.statusInfo}))}var o,a,l=require("jquery"),u=require("etpl"),c=require("moment"),m=require("common/data"),d=require("common/header"),f=require("common/ui/Pager/Pager"),h=require("common/Remoter"),g=new h("MY_INVEST_GET"),v=new h("MY_INVEST_DETAIL"),E=new h("MY_INVEST_TENDERING"),p=new h("MY_INVEST_ENDED"),C=new h("MY_INVEST_TENDERFAIL"),w=require("./list.tpl"),I=1,b=null,T="YYYY-MM-DD";return{init:e}});