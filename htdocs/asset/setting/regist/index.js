define("setting/regist/index",["require","jquery","../common/picScroll","common/header","common/Remoter"],function(require){function e(e){i=e?1:0,s.init(),t.init(),r(),n()}function r(){o(".regist .login-input").on({focus:function(){var e=o(this).parent(),r=e.children(".username-error");e.removeClass("current"),r.html(""),o(this).next().addClass("hidden")},blur:function(){var e=o(this).parent(),r=o.trim(o(this).val()),n=o(this).attr("data-text"),i=o(this).attr("id");if(!r){if(!o(this).hasClass("login-tuijian"))e.addClass("current"),o("#"+i+"-error").html(n+"不能为空");o(this).next().removeClass("hidden")}}}),v.loginUser.blur(function(){var e=o.trim(o(this).val());if(e)a.remote({name:e});else C.user=0}),v.loginPwd.blur(function(){var e=o.trim(o(this).val());if(!e)return void(C.pwd=0);if(!f.test(e))return C.pwd=0,o(this).parent().addClass("current"),void p.pwdError.html("密码只能为 6 - 32 位数字，字母及常用符号组成");else return C.pwd=1,void p.pwdError.html(h)}),v.loginPhone.blur(function(){var e=o.trim(o(this).val());if(e)u.remote({phone:e});else C.phone=0,o(".login-username-testing").addClass("disabled")}),v.loginTest.blur(function(){var e=o.trim(o(this).val()),r=o.trim(v.loginPhone.val());if(!r)return v.loginPhone.trigger("blur"),void(C.vericode=0);if(e)d.remote({vericode:e,phone:r,type:1});else C.vericode=0}),o(".login-username-testing").click(function(e){e.preventDefault();var r=o.trim(v.loginPhone.val());if(!o(this).hasClass("disabled")&&r)c.remote({phone:r,type:1})}),v.loginTuiJian.blur(function(){var e=o.trim(o(this).val());if(e)g.remote({inviter:e})}),o(".regist .login-fastlogin").click(function(e){e.preventDefault();var r=1;if(!o("#tiaoyue-itp")[0].checked)return void alert("请同意用户条约");for(var n in C)if(C.hasOwnProperty(n))if(!C[n])v[E[n]].trigger("blur"),r=0;r&&m.remote({name:v.loginUser.val(),passwd:v.loginPwd.val(),phone:v.loginPhone.val(),inviter:v.loginTuiJian.val(),vericode:v.loginTest.val(),isthird:i})})}function n(){var e;a.on("success",function(e){if(e&&e.bizError)v.loginUser.parent().addClass("current"),p.userError.html(e.statusInfo),C.user=0;else p.userError.html(h),C.user=1}),u.on("success",function(e){if(e&&e.bizError)v.loginPhone.parent().addClass("current"),p.phoneError.html(e.statusInfo),C.phone=0,o(".login-username-testing").addClass("disabled");else p.phoneError.html(h),C.phone=1,o(".login-username-testing").removeClass("disabled")}),g.on("success",function(e){if(e&&e.bizError)v.loginTuiJian.parent().addClass("current"),p.tuiJianError.html(e.statusInfo),C.tui=0;else p.tuiJianError.html(h),C.tui=1}),c.on("success",function(r){var n=60;if(r&&r.bizError)alert(r.statusInfo);else{var i=o("#testing-wait");i.text("60秒后重新发送"),i.addClass("show"),e=setInterval(function(){if(i.text(--n+"秒后重新发送"),0>n)clearInterval(e),i.removeClass("show")},1e3)}}),d.on("success",function(e){if(e&&e.bizError)v.loginTest.parent().addClass("current"),p.testError.html(e.statusInfo),C.vericode=0;else p.testError.html(h),C.vericode=1}),m.on("success",function(e){if(e&&e.bizError)alert(e.statusInfo);else window.location.href="/user/open/index"})}var i,o=require("jquery"),t=require("../common/picScroll"),s=require("common/header"),l=require("common/Remoter"),a=new l("REGIST_CHECKNAME_CHECK"),u=new l("REGIST_CHECKPHONE_CHECK"),c=new l("REGIST_SENDSMSCODE_CHECK"),g=new l("REGIST_CHECKINVITER_CHECK"),d=new l("REGIST_CHECKSMSCODE_CHECK"),m=new l("REGIST_INDEX_CHECK"),f=/^[a-zA-Z0-9!@#$%^&'\(\({}=+\-]{6,20}$/,h='<span class="username-error-span"></span>',v={loginUser:o("#regist-user"),loginPwd:o("#regist-pwd"),loginPhone:o("#regist-phone"),loginTest:o("#regist-testing"),loginTuiJian:o("#regist-tuijian")},p={userError:o("#regist-user-error"),phoneError:o("#regist-phone-error"),pwdError:o("#regist-pwd-error"),testError:o("#regist-testing-error"),tuiJianError:o("#regist-tuijian-error")},C={user:0,phone:0,pwd:0,vericode:0,tui:1},E={user:"loginUser",phone:"loginPhone",pwd:"loginPwd",vericode:"loginTest",tui:"loginTuiJian"};return{init:e}});