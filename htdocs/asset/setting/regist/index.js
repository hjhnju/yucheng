/*! 2014 Baidu Inc. All Rights Reserved */
define("setting/regist/index",["require","jquery","../common/picScroll","common/header","common/Remoter"],function(require){function r(){o.init(),t.init(),e(),n()}function e(){i(".regist .login-input").on({focus:function(){var r=i(this).parent(),e=r.children(".username-error");r.removeClass("current"),e.html(""),i(this).next().addClass("hidden")},blur:function(){var r=i(this).parent(),e=i.trim(i(this).val()),n=i(this).attr("data-text"),t=i(this).attr("id");if(!e){if(!i(this).hasClass("login-tuijian"))r.addClass("current"),i("#"+t+"-error").html(n+"不能为空");i(this).next().removeClass("hidden")}}}),d.loginUser.blur(function(){var r=i.trim(i(this).val());if(r)l.remote({name:r})}),d.loginPwd.blur(function(){var r=i.trim(i(this).val());if(r)if(!g.test(r))return i(this).parent().addClass("current"),void v.pwdError.html("密码只能为 6 - 32 位数字，字母及常用符号组成");else return void v.pwdError.html(h)}),d.loginPhone.blur(function(){var r=i.trim(i(this).val());if(r)a.remote({phone:r})}),d.loginTest.blur(function(){var r=i.trim(i(this).val()),e=i.trim(d.loginPhone.val());if(!e)return void d.loginPhone.trigger("blur");if(r)m.remote({vericode:r,phone:e})}),i(".login-username-testing").click(function(r){r.preventDefault();var e=i.trim(d.loginPhone.val());if(e)u.remote({phone:e})}),d.loginTuiJian.blur(function(){var r=i.trim(i(this).val());if(r)c.remote({inviter:r})}),i(".regist .login-fastlogin").click(function(r){r.preventDefault(),i(".regist .login-input").trigger("blur");var e=i(".regist .login-username.current");if(!i("#tiaoyue-itp")[0].checked)return void alert("请同意用户条约");if(!e.length)f.remote({name:d.loginUser.val(),passwd:d.loginPwd.val(),phone:d.loginPhone.val(),inviter:d.loginTuiJian.val()})})}function n(){var r;l.on("success",function(r){if(r&&r.bizError)d.loginUser.parent().addClass("current"),v.userError.html(r.statusInfo);else v.userError.html(h)}),a.on("success",function(r){if(r&&r.bizError)d.loginPhone.parent().addClass("current"),v.phoneError.html(r.statusInfo);else v.phoneError.html(h)}),c.on("success",function(r){if(r&&r.bizError)d.loginTuiJian.parent().addClass("current"),v.tuiJianError.html(r.statusInfo);else v.tuiJianError.html(h)}),u.on("success",function(e){var n=300;if(e&&e.bizError)alert(e.statusInfo);else{var t=i("#testing-wait");t.text("300秒后重新发送"),t.addClass("show"),r=setInterval(function(){if(t.text(--n+"秒后重新发送"),0>n)clearInterval(r),t.removeClass("show")},1e3)}}),m.on("success",function(r){if(r&&r.bizError)d.loginTest.parent().addClass("current"),v.testError.html(r.statusInfo);else v.testError.html(h)}),f.on("success",function(r){if(r&&r.bizError)alert(r.statusInfo);else window.location.href="http://www.baidu.com"})}var i=require("jquery"),t=require("../common/picScroll"),o=require("common/header"),s=require("common/Remoter"),l=new s("REGIST_CHECKNAME_CHECK"),a=new s("REGIST_CHECKPHONE_CHECK"),u=new s("REGIST_SENDSMSCODE_CHECK"),c=new s("REGIST_CHECKINVITER_CHECK"),m=new s("REGIST_CHECKSMSCODE_CHECK"),f=new s("REGIST_INDEX_CHECK"),g=/^[a-zA-Z0-9!@#$%^&'\(\({}=+\-]{6,20}$/,h='<span class="username-error-span"></span>',d={loginUser:i("#regist-user"),loginPwd:i("#regist-pwd"),loginPhone:i("#regist-phone"),loginTest:i("#regist-testing"),loginTuiJian:i("#regist-tuijian")},v={userError:i("#regist-user-error"),phoneError:i("#regist-phone-error"),pwdError:i("#regist-pwd-error"),testError:i("#regist-testing-error"),tuiJianError:i("#regist-tuijian-error")};return{init:r}});