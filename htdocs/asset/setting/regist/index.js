/*! 2014 Baidu Inc. All Rights Reserved */
define("setting/regist/index",function(require){function r(){i.init(),n(),e()}function n(){t(".regist .login-input").on({focus:function(){var r=t(this).parent(),n=r.children(".username-error");r.removeClass("current"),n.html(""),t(this).next().addClass("hidden")},blur:function(){var r=t(this).parent(),n=t.trim(t(this).val()),e=t(this).attr("data-text"),i=t(this).attr("id");if(!n){if(!t(this).hasClass("login-tuijian"))r.addClass("current"),t("#"+i+"-error").html(e+"不能为空");t(this).next().removeClass("hidden")}}}),h.loginUser.blur(function(){var r=t.trim(t(this).val());if(r)s.remote({name:r})}),h.loginPwd.blur(function(){var r=t.trim(t(this).val());if(r)if(!g.test(r))return t(this).parent().addClass("current"),void d.pwdError.html("密码只能为 6 - 32 位数字，字母及常用符号组成");else return void d.pwdError.html(m)}),h.loginPhone.blur(function(){var r=t.trim(t(this).val());if(r)l.remote({phone:r})}),h.loginTest.blur(function(){var r=t.trim(t(this).val()),n=t.trim(h.loginPhone.val());if(!n)return void h.loginPhone.trigger("blur");if(r)c.remote({vericode:r,phone:n})}),t(".login-username-testing").click(function(r){r.preventDefault();var n=t.trim(h.loginPhone.val());if(n)a.remote({phone:n})}),h.loginTuiJian.blur(function(){var r=t.trim(t(this).val());if(r)u.remote({inviter:r})}),t(".regist .login-fastlogin").click(function(r){r.preventDefault(),t(".regist .login-input").trigger("blur");var n=t(".regist .login-username.current");if(!t("#tiaoyue-itp")[0].checked)return void alert("请同意用户条约");if(!n.length)f.remote({name:h.loginUser.val(),passwd:h.loginPwd.val(),phone:h.loginPhone.val(),inviter:h.loginTuiJian.val()})})}function e(){var r;s.on("success",function(r){if(r&&r.bizError)h.loginUser.parent().addClass("current"),d.userError.html(r.statusInfo);else d.userError.html(m)}),l.on("success",function(r){if(r&&r.bizError)h.loginPhone.parent().addClass("current"),d.phoneError.html(r.statusInfo);else d.phoneError.html(m)}),u.on("success",function(r){if(r&&r.bizError)h.loginTuiJian.parent().addClass("current"),d.tuiJianError.html(r.statusInfo);else d.tuiJianError.html(m)}),a.on("success",function(n){var e=300;if(n&&n.bizError)alert(n.statusInfo);else{var i=t("#testing-wait");i.text("300秒后重新发送"),i.addClass("show"),r=setInterval(function(){if(i.text(--e+"秒后重新发送"),0>e)clearInterval(r),i.removeClass("show")},1e3)}}),c.on("success",function(r){if(r&&r.bizError)h.loginTest.parent().addClass("current"),d.testError.html(r.statusInfo);else d.testError.html(m)}),f.on("success",function(r){if(r&&r.bizError)alert(r.statusInfo);else window.location.href="http://www.baidu.com"})}var t=require("jquery"),i=require("../common/picScroll"),o=require("common/Remoter"),s=new o("REGIST_CHECKNAME_CHECK"),l=new o("REGIST_CHECKPHONE_CHECK"),a=new o("REGIST_SENDSMSCODE_CHECK"),u=new o("REGIST_CHECKINVITER_CHECK"),c=new o("REGIST_CHECKSMSCODE_CHECK"),f=new o("REGIST_INDEX_CHECK"),g=/^[a-zA-Z0-9!@#$%^&'\(\({}=+\-]{6,20}$/,m='<span class="username-error-span"></span>',h={loginUser:t("#regist-user"),loginPwd:t("#regist-pwd"),loginPhone:t("#regist-phone"),loginTest:t("#regist-testing"),loginTuiJian:t("#regist-tuijian")},d={userError:t("#regist-user-error"),phoneError:t("#regist-phone-error"),pwdError:t("#regist-pwd-error"),testError:t("#regist-testing-error"),tuiJianError:t("#regist-tuijian-error")};return{init:r}});